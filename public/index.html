<!DOCTYPE html>
<html>
  <head>
    <title>URL SHORTNER</title>
  </head>
  <body>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-firestore.js"></script>
    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyA4f65a7OJao3naT00CT2tKsLdFGD1P_ig",
        authDomain: "url-shortner-2c163.firebaseapp.com",
        databaseURL: "https://url-shortner-2c163.firebaseio.com",
        projectId: "url-shortner-2c163",
        storageBucket: "url-shortner-2c163.appspot.com",
        messagingSenderId: "989201405789",
        appId: "1:989201405789:web:fb9063fdb5069f4b41fab4",
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
      var url = window.location.href;
      var nochar = url.length;
      var object = url.split("/");
      var name = object[3];
      if (name == "") {
        window.location.replace("./mainpage.html");
      } else {
        var docRef = db.collection("STORED-URLS").doc(name);
        docRef
          .get()
          .then(function (doc) {
            if (doc.exists) {
              window.location.href = doc.data().REDIRECT;
            } else {
              window.location.replace("./mainpage.html");
            }
          })
          .catch(function (error) {
            window.location.replace("./mainpage.html");
          });
      }
    </script>
  </body>
</html>
